<% provide :head_tags do %>
  <meta name='turbolinks-visit-control' content='reload'>
  <script>
    document.addEventListener("DOMContentLoaded", function(){
      indexMap(<%=@spots_list%>)
    });
  </script>
<% end %>

<p id="notice"><%= notice %></p>

<h1>Spots</h1>

<table>
  <thead>
    <tr>
      <th>Time to Leave</th>
      <th>Going</th>
      <!-- <th>Latitude</th>
      <th>Longitude</th> -->
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% ascending_sort  = ->(a,b) { time_in_sec(a.time2leave) <=> time_in_sec(b.time2leave) } %>
    <% @spots.sort( & ascending_sort ).each do |spot| %>
      <tr>
        <td><%= time_difference(spot.time2leave) %></td>
        <td><%= spot.going %></td>
        <!-- <td><%= spot.latitude %></td>
        <td><%= spot.longitude %></td> -->
        <td><%= link_to 'Show', spot %></td>
        <td><%= link_to 'Edit', edit_spot_path(spot) %></td>
        <td><%= link_to 'Destroy', spot, method: :delete, data: { confirm: 'Are you sure?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>



<br>

<%= link_to 'New Spot', new_spot_path %>

<p>
  <div id="indexMap"></div>
</p>